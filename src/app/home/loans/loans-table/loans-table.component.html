<loans-banner (bannerFormSubmit)="onLoanBannerFormSubmit($event)"> </loans-banner>

<div class="container-fluid">
  <div class="row">
    <div class="col-12">
        <div class="loans__request">
            <button mat-raised-button color="primary" class="loans__request__btn" (click)="onRequestLoansFromAllBanks()">
              {{'~requestLoansFromAllBanks' | translate}}
            </button>
          </div>
    </div>
  </div>
  <div class="row" >
    <div class="col-12">
        <div class="loans__table">
          <div id="loans-table-filter" class="loans__table__filter">


              <form #f="ngForm">

                  <div class="loans__table__filter__btn --ck-button">
                      <label>
                         <input type="checkbox" value="false" ngModel name ="withEmpReference"><span>{{'~withEmpReference' | translate |titlecase}}</span>
                      </label>
                   </div>

                  <div class="loans__table__filter__btn --ck-button">
                      <label>
                         <input type="checkbox" value="false" ngModel name ="withCollateral"><span>{{'~withCollateral' | translate |titlecase}}</span>
                      </label>
                   </div>

                  <div class="loans__table__filter__btn --ck-button">
                      <label>
                         <input type="checkbox" value="false" ngModel name ="withGracePeriod"><span>{{'~withGracePeriod' | translate |titlecase}}</span>
                      </label>
                   </div>

                  <div class="loans__table__filter__btn --ck-button">
                      <label>
                         <input type="checkbox" value="false" ngModel name ="comissionCash"><span>{{'~commissionCash' | translate |titlecase}}</span>
                      </label>
                   </div>
                  <div class="loans__table__filter__btn --ck-button">
                      <label>
                         <input type="checkbox" value="false" ngModel name ="comissionLoan"><span>{{'~commissionLoan' | translate |titlecase}}</span>
                      </label>
                   </div>

            </form>


        </div>
          <div class="loans__table__content">
              <table-loader *ngIf="loading"></table-loader>
              <table id="loans-table2" class="table plus-minus" *ngIf="loanProducts && !loading">
                <thead>
                  <th>
                    <div class="th-content">
                        {{'~bank' | translate | titlecase}}
                        <div class="tableSorting" >
                          <span class="tableSorting__arrow" (click)="onSort('bankName',  'asc')" [ngClass]="{'active': isActiveSort('bankName', 'asc')}" >
                              <mat-icon>keyboard_arrow_up</mat-icon>
                            </span>
                            <span class="tableSorting__arrow" (click)="onSort('bankName',  'desc')" [ngClass]="{'active': isActiveSort('bankName', 'desc')}">
                               <mat-icon>keyboard_arrow_down</mat-icon>
                            </span>
                       </div>
                    </div>
                  </th>
                  <th>
                    <div class="th-content">
                        {{'~loanName' | translate | titlecase}}
                    </div>
                  </th>
                  <th>
                      <div class="th-content">
                       {{'~effectiveRate' | translate | titlecase}}
                       <div class="tableSorting" >
                        <span class="tableSorting__arrow" (click)="onSort('minRate', 'asc')" [ngClass]="{'active': isActiveSort('minRate', 'asc')}" >
                            <mat-icon>keyboard_arrow_up</mat-icon>
                          </span>
                          <span class="tableSorting__arrow" (click)="onSort('minRate', 'desc')" [ngClass]="{'active': isActiveSort('minRate', 'desc')}">
                             <mat-icon>keyboard_arrow_down</mat-icon>
                          </span>
                     </div>
                     </div>
                  </th>
                  <th>
                    <div class="th-content">
                        {{'~amount' | translate | titlecase}}
                        <div class="tableSorting" >
                          <span class="tableSorting__arrow" (click)="onSort('minAmount', 'asc')" [ngClass]="{'active': isActiveSort('minAmount', 'asc')}" >
                              <mat-icon>keyboard_arrow_up</mat-icon>
                            </span>
                            <span class="tableSorting__arrow" (click)="onSort('minAmount', 'desc')" [ngClass]="{'active': isActiveSort('minAmount', 'desc')}">
                               <mat-icon>keyboard_arrow_down</mat-icon>
                            </span>
                       </div>
                    </div>
                  </th>

                  <th>
                    <div class="th-content">
                        {{'~monthlyPayment' | translate | titlecase}}
                        <div class="tableSorting" >
                          <span class="tableSorting__arrow" (click)="onSort('minMonthlyPayment', 'asc')" [ngClass]="{'active': isActiveSort('minMonthlyPayment', 'asc')}" >
                              <mat-icon>keyboard_arrow_up</mat-icon>
                            </span>
                            <span class="tableSorting__arrow" (click)="onSort('maxMonthlyPayment', 'desc')" [ngClass]="{'active': isActiveSort('maxMonthlyPayment', 'desc')}">
                               <mat-icon>keyboard_arrow_down</mat-icon>
                            </span>
                       </div>
                    </div>
                  </th>

                  <th>
                    <div class="th-content" *ngIf="!isMobile">
                        {{'~documents' | translate | titlecase}}
                    </div>
                  </th>
                  <th >
                    <div class="th-content" *ngIf="!isMobile">
                        {{'~requirements' | translate | titlecase}}
                    </div>
                  </th>
                  <th></th>
                </thead>
                <tbody>
                  <tr *ngFor="let loan of loanProducts" [attr.loan-id]="loan.lnID">
                    <td valign="top">
                      <div class="td-content loans__table__content__bank"
                      >
                          <div class="loans__table__content__bank__icon" >
                             <img  src="./assets/icons/banks/{{loan.bankID}}.svg" alt="{{loan.bankName}}" [attr.loan-img-id]="loan.lnID">
                          </div>
                          <div class="expand-icon"  (click)="onExpandToggle(loan.lnID)" [ngClass]="{'--top' : (expandedNode === loan.lnID)}">
                              <i class="fas fa-chevron-down"></i>
                          </div>
                      </div>

                    </td>

                    <td valign="top">
                      <div class="td-content">
                         {{loan.loanName | valueTranslate | titlecase}}
                      </div>
                    </td>

                    <td valign="top">
                      <div class="td-content --rate">
                         {{loan.minRate}} %
                      </div>
                    </td>

                    <td valign="top">
                      <div class=" td-content --amount" >
                        <div>
                          <span [countUp]="loan.minAmount">0</span> {{loan.currencyCode | lowercase}}
                        -  <span [countUp]="loan.maxAmount">0</span>  {{loan.currencyCode | lowercase}}
                           <br class="d-none d-sm-block">
                           <span>({{loan.minPeriod }} - {{loan.maxPeriod}} {{'~month' | translate}})</span>

                        </div>
                      </div>
                    </td>

                    <td valign="top">
                      <div class=" td-content" >
                        <ng-container *ngIf="loan.minMonthlyPayment && loan.maxMonthlyPayment">
                            {{loan.minMonthlyPayment }} -
                            {{loan.maxMonthlyPayment}}
                           {{loan.currencyCode | lowercase}}
                        </ng-container>

                        <ng-container *ngIf="loan.minMonthlyPayment && !loan.maxMonthlyPayment">
                            {{loan.minMonthlyPayment }}
                           {{loan.currencyCode | lowercase}}
                        </ng-container>

                        <ng-container *ngIf="!loan.minMonthlyPayment && loan.maxMonthlyPayment">
                            {{loan.maxMonthlyPayment }}
                           {{loan.currencyCode | lowercase}}
                        </ng-container>

                        </div>
                    </td>

                    <td valign="top"  *ngIf="(isMobile && (expandedNode === loan.lnID) ) || !isMobile">
                      <div class=" td-content" [ngClass]="{'table-expanded' : (expandedNode === loan.lnID) || isMobile }" >
                        <div *ngFor="let item of (loan.descriptionDoc | valueTranslate).split('\n')">
                            {{item}} <br>
                        </div>
                      </div>
                    </td>
                    <td valign="top" *ngIf="(isMobile && (expandedNode === loan.lnID) ) || !isMobile ">
                      <div class=" td-content" [ngClass]="{'table-expanded' : (expandedNode === loan.lnID) || isMobile }"
                        >
                        <div >
                         {{loan.description | valueTranslate}}
                        </div>
                      </div>
                    </td>
                    <td valign="top" class="pl-0 pr-0">
                      <div class="td-content row-actions" >
                          <button mat-raised-button
                          color="primary" routerLink="/home/loans/compare"
                          [queryParams]="{lnID: loan.lnID}"
                          >{{'~detailed' | translate}}</button>
                          <button mat-raised-button color="accent" [id]="loan?.lnID"
                          fly-to-cart
                           [disabled]="(canAddProductToCompare(loan?.lnID) | async)"
                            (click)="onAddProductToCompare(loan)">{{'~addToCart' | translate}}</button>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
          </div>
        </div>
    </div>
  </div>
</div>
